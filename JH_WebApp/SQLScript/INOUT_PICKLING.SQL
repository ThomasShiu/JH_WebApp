  SELECT POLESN,POLENO,POOLNO,FINISHED,ROLLNO_1,ROLLNO_2,ROLLNO_3,ROLLNO_4,BDT,NVL(LEAD_EDT,SYSDATE) LEAD_EDT,
  ROUND((NVL(LEAD_EDT,SYSDATE)-BDT)*24*60) AS GAP_MIN
 FROM (
 SELECT  A.POLESN, B.POLENO,A.POOLNO,B.FINISHED ,
         (
          SELECT (B.ROLLNO_1||','||WIR_KIND||','||DRAW_DIA) AS ROLLNO_1
          FROM JHEIP.V_ASK_DRW_STOK WHERE COIL_NO=B.ROLLNO_1
         ) ROLLNO_1,
         (
          SELECT (B.ROLLNO_2||','||WIR_KIND||','||DRAW_DIA) AS ROLLNO_2
          FROM JHEIP.V_ASK_DRW_STOK WHERE COIL_NO=B.ROLLNO_2
         ) ROLLNO_2,
         (
          SELECT (B.ROLLNO_3||','||WIR_KIND||','||DRAW_DIA) AS ROLLNO_3
          FROM JHEIP.V_ASK_DRW_STOK WHERE COIL_NO=B.ROLLNO_3
         ) ROLLNO_3,
         (
          SELECT (B.ROLLNO_4||','||WIR_KIND||','||DRAW_DIA) AS ROLLNO_4
          FROM JHEIP.V_ASK_DRW_STOK WHERE COIL_NO=B.ROLLNO_4
         ) ROLLNO_4,
          A.BDT, A.EDT,NVL(A.EDT,LEAD(A.BDT) OVER (ORDER BY A.BDT)) AS LEAD_EDT 
 FROM JHEIP.MES_INOUT_PICKLING A,JHEIP.MES_POLE_PICKLING B
 WHERE A.POLESN=B.POLESN 
 AND A.POLESN =  '{0}'
 ) X
